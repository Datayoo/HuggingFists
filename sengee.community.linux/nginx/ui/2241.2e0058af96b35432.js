"use strict";(self.webpackChunksengee_ui=self.webpackChunksengee_ui||[]).push([[2241],{42241:(R,J,r)=>{r.d(J,{Q:()=>ot});var n=r(28076),u=r(34654),t=r(5e3),O=r(90056),k=r(49727),P=r(89445),b=r(77152),f=r(91156),h=r(69808),M=r(404),A=r(91984),I=r(62545),Z=r(18393),N=r(72394),Q=r(55535),j=r(6462),E=r(93075),F=r(49841),D=r(63640),B=r(64085);const U=["taskList"],d=["schedulerTable"],C=["jobVariable"];function i(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"i",7),t.NdJ("click",function(){return t.CHM(e),t.oxw().onReturn()}),t.ALo(1,"nzI18n"),t.qZA()}2&a&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.return"))}function c(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"i",16),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).addJob("immediate")}),t.ALo(1,"nzI18n"),t.qZA()}2&a&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.add"))}function p(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"i",17),t.NdJ("click",function(){return t.CHM(e),t.oxw(),t.MAs(11).batchDelete()}),t.ALo(1,"nzI18n"),t.qZA()}if(2&a){t.oxw();const e=t.MAs(11);t.Q6J("disabled",!(null!=e.table&&e.table.checked||null!=e.table&&e.table.indeterminate))("nz-tooltip",t.lcZ(1,2,"BatchDelete.title"))}}function m(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"dy-tab",8),t.ALo(1,"nzI18n"),t.TgZ(2,"div",9)(3,"div",10)(4,"span"),t.YNc(5,c,2,3,"ng-template",11),t.YNc(6,p,2,4,"ng-template",11),t.TgZ(7,"i",12),t.NdJ("click",function(){return t.CHM(e),t.MAs(11).refresh(!0)}),t.ALo(8,"nzI18n"),t.qZA()()(),t.TgZ(9,"div",13),t._UZ(10,"app-task-list",14,15),t.qZA()()()}if(2&a){const e=t.oxw();t.Q6J("alias",t.lcZ(1,11,"job.immediate")),t.xp6(2),t.Q6J("ngStyle",e.contentStyle),t.xp6(3),t.Q6J("behavior","job.create")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("behavior","job.batchDelete")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(8,13,"base.refresh")),t.xp6(3),t.Q6J("groupId",e.groupId)("processId",e.processId)}}function x(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"i",16),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).addJob("scheduler")}),t.ALo(1,"nzI18n"),t.qZA()}2&a&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.add"))}function H(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"i",17),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).batchDelete("scheduler")}),t.ALo(1,"nzI18n"),t.qZA()}if(2&a){t.oxw();const e=t.MAs(11);t.Q6J("disabled",!e.checked&&!e.indeterminate)("nz-tooltip",t.lcZ(1,2,"BatchDelete.title"))}}function T(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"i",22),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).currentJob=s}),t.qZA(),t.TgZ(1,"i",23),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).editJob("scheduler",s)}),t.ALo(2,"nzI18n"),t.qZA(),t.TgZ(3,"i",24),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).runJob(s)}),t.qZA(),t.TgZ(4,"i")(5,"nz-switch",25),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).enableJob(s)}),t.qZA()(),t.TgZ(6,"i",26),t.NdJ("nzOnConfirm",function(){const s=t.CHM(e).$implicit;return t.oxw(2).deleteConfirm(s,"scheduler")}),t.ALo(7,"nzI18n"),t.ALo(8,"nzI18n"),t.ALo(9,"nzI18n"),t.qZA()}if(2&a){const e=_.$implicit;t.Q6J("nz-tooltip","\u67e5\u770b\u4efb\u52a1\u5217\u8868"),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(2,8,"base.edit")),t.xp6(2),t.Q6J("disabled",!e.enabled)("nz-tooltip","\u7acb\u5373\u6267\u884c"),t.xp6(2),t.Q6J("ngModel",e.enabled)("nzControl",!0),t.xp6(1),t.Q6J("nzPopconfirmTitle",t.lcZ(7,10,"base.confirmDel")+t.lcZ(8,12,"menu.job")+"?")("nz-tooltip",t.lcZ(9,14,"base.delete"))}}function y(a,_){if(1&a&&(t.TgZ(0,"a",27),t._uU(1),t.qZA()),2&a){const e=_.$implicit;t.Q6J("href",e.trackUrl,t.LSH),t.xp6(1),t.Oqu(e.trackUrl)}}function L(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"dy-tab",8),t.ALo(1,"nzI18n"),t.TgZ(2,"div",9)(3,"div",10)(4,"span"),t.YNc(5,x,2,3,"ng-template",11),t.YNc(6,H,2,4,"ng-template",11),t.TgZ(7,"i",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().schedulerJobList(!0)}),t.ALo(8,"nzI18n"),t.qZA()()(),t.TgZ(9,"div",13)(10,"app-table",18,19),t.NdJ("pageChange",function(l){return t.CHM(e),t.oxw().pageChangeHandler(l,"scheduler")}),t.YNc(12,T,10,16,"ng-template",20),t.YNc(13,y,2,2,"ng-template",21),t.qZA()()()()}if(2&a){const e=t.oxw();t.Q6J("alias",t.lcZ(1,14,"job.scheduler")),t.xp6(2),t.Q6J("ngStyle",e.contentStyle),t.xp6(3),t.Q6J("behavior","job.create")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("behavior","job.batchDelete")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(8,16,"base.refresh")),t.xp6(3),t.Q6J("columns",e.columns)("data",e.schedulerJobListData)("total",e.schedulerPage.total)("pageIndex",e.schedulerPage.pageIndex)("pageSize",e.schedulerPage.pageSize)}}function $(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"i",16),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).addJob("interaction")}),t.ALo(1,"nzI18n"),t.qZA()}2&a&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.add"))}function S(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"i",17),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).batchDelete("interaction")}),t.ALo(1,"nzI18n"),t.qZA()}if(2&a){t.oxw();const e=t.MAs(11);t.Q6J("disabled",!e.checked&&!e.indeterminate)("nz-tooltip",t.lcZ(1,2,"BatchDelete.title"))}}function Y(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"i",22),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).currentJob=s}),t.qZA(),t.TgZ(1,"i",23),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).editJob("interaction",s)}),t.ALo(2,"nzI18n"),t.qZA(),t.TgZ(3,"i",24),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).runJob(s)}),t.qZA(),t.TgZ(4,"i")(5,"nz-switch",25),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).enableJob(s)}),t.qZA()(),t.TgZ(6,"i",26),t.NdJ("nzOnConfirm",function(){const s=t.CHM(e).$implicit;return t.oxw(2).deleteConfirm(s,"interaction")}),t.ALo(7,"nzI18n"),t.ALo(8,"nzI18n"),t.ALo(9,"nzI18n"),t.qZA()}if(2&a){const e=_.$implicit;t.Q6J("nz-tooltip","\u67e5\u770b\u4efb\u52a1\u5217\u8868"),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(2,8,"base.edit")),t.xp6(2),t.Q6J("disabled",!e.enabled)("nz-tooltip","\u7acb\u5373\u6267\u884c"),t.xp6(2),t.Q6J("ngModel",e.enabled)("nzControl",!0),t.xp6(1),t.Q6J("nzPopconfirmTitle",t.lcZ(7,10,"base.confirmDel")+t.lcZ(8,12,"menu.job")+"?")("nz-tooltip",t.lcZ(9,14,"base.delete"))}}function V(a,_){if(1&a&&(t.TgZ(0,"a",27),t._uU(1),t.qZA()),2&a){const e=_.$implicit;t.Q6J("href",e.trackUrl,t.LSH),t.xp6(1),t.Oqu(e.trackUrl)}}function W(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"dy-tab",8),t.ALo(1,"nzI18n"),t.TgZ(2,"div",9)(3,"div",10)(4,"span"),t.YNc(5,$,2,3,"ng-template",11),t.YNc(6,S,2,4,"ng-template",11),t.TgZ(7,"i",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().interactionJobList(!0)}),t.ALo(8,"nzI18n"),t.qZA()()(),t.TgZ(9,"div",13)(10,"app-table",18,28),t.NdJ("pageChange",function(l){return t.CHM(e),t.oxw().pageChangeHandler(l,"interaction")}),t.YNc(12,Y,10,16,"ng-template",29),t.YNc(13,V,2,2,"ng-template",30),t.qZA()()()()}if(2&a){const e=t.oxw();t.Q6J("alias",t.lcZ(1,14,"job.interaction")),t.xp6(2),t.Q6J("ngStyle",e.contentStyle),t.xp6(3),t.Q6J("behavior","job.create")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("behavior","job.batchDelete")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(8,16,"base.refresh")),t.xp6(3),t.Q6J("columns",e.interactionColumns)("data",e.interactionJobListData)("total",e.interactionPage.total)("pageIndex",e.interactionPage.pageIndex)("pageSize",e.interactionPage.pageSize)}}function K(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"i",16),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).addJob("event")}),t.ALo(1,"nzI18n"),t.qZA()}2&a&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.add"))}function G(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"i",17),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).batchDelete("event")}),t.ALo(1,"nzI18n"),t.qZA()}if(2&a){t.oxw();const e=t.MAs(11);t.Q6J("disabled",!e.checked&&!e.indeterminate)("nz-tooltip",t.lcZ(1,2,"BatchDelete.title"))}}function q(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"i",22),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).currentJob=s}),t.qZA(),t.TgZ(1,"i",23),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).editJob("event",s)}),t.ALo(2,"nzI18n"),t.qZA(),t.TgZ(3,"i",24),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).runEventJob(s)}),t.qZA(),t.TgZ(4,"i")(5,"nz-switch",25),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).enableJob(s)}),t.qZA()(),t.TgZ(6,"i",26),t.NdJ("nzOnConfirm",function(){const s=t.CHM(e).$implicit;return t.oxw(2).deleteConfirm(s,"event")}),t.ALo(7,"nzI18n"),t.ALo(8,"nzI18n"),t.ALo(9,"nzI18n"),t.qZA()}if(2&a){const e=_.$implicit;t.Q6J("nz-tooltip","\u67e5\u770b\u4efb\u52a1\u5217\u8868"),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(2,8,"base.edit")),t.xp6(2),t.Q6J("disabled",!e.enabled)("nz-tooltip","\u7acb\u5373\u6267\u884c"),t.xp6(2),t.Q6J("ngModel",e.enabled)("nzControl",!0),t.xp6(1),t.Q6J("nzPopconfirmTitle",t.lcZ(7,10,"base.confirmDel")+t.lcZ(8,12,"menu.job")+"?")("nz-tooltip",t.lcZ(9,14,"base.delete"))}}function X(a,_){if(1&a&&(t.TgZ(0,"a",27),t._uU(1),t.qZA()),2&a){const e=_.$implicit;t.Q6J("href",e.trackUrl,t.LSH),t.xp6(1),t.Oqu(e.trackUrl)}}function tt(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"dy-tab",8),t.ALo(1,"nzI18n"),t.TgZ(2,"div",9)(3,"div",10)(4,"span"),t.YNc(5,K,2,3,"ng-template",11),t.YNc(6,G,2,4,"ng-template",11),t.TgZ(7,"i",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().eventJobList(!0)}),t.ALo(8,"nzI18n"),t.qZA()()(),t.TgZ(9,"div",13)(10,"app-table",18,31),t.NdJ("pageChange",function(l){return t.CHM(e),t.oxw().pageChangeHandler(l,"event")}),t.YNc(12,q,10,16,"ng-template",32),t.YNc(13,X,2,2,"ng-template",33),t.qZA()()()()}if(2&a){const e=t.oxw();t.Q6J("alias",t.lcZ(1,14,"job.event")),t.xp6(2),t.Q6J("ngStyle",e.contentStyle),t.xp6(3),t.Q6J("behavior","job.create")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("behavior","job.batchDelete")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(8,16,"base.refresh")),t.xp6(3),t.Q6J("columns",e.eventColumns)("data",e.eventJobListData)("total",e.eventPage.total)("pageIndex",e.eventPage.pageIndex)("pageSize",e.eventPage.pageSize)}}function et(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"div",34)(1,"app-task-list",35),t.NdJ("lookLog",function(l){return t.CHM(e),t.oxw().currentTask=l})("onReturn",function(){return t.CHM(e),t.oxw().currentJob=null}),t.qZA()()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("info","\u4f5c\u4e1a\u540d\u79f0: "+(null==e.currentJob?null:e.currentJob.name))("jobId",null==e.currentJob?null:e.currentJob.id)}}function nt(a,_){if(1&a&&(t.ynx(0),t._UZ(1,"app-job-variable",36,37),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("variableData",e.jobVariableData)}}let ot=(()=>{class a{constructor(e,o,l,s,g,it){this.api=e,this.prcApi=o,this.message=l,this.i18n=s,this.router=g,this.deleteSer=it,this.columns=[{type:"checkbox"},{type:"index"},{i18n:"base.name",field:"name"},{i18n:"job.priority",field:"priorityZh",filterMultiple:!0,listOfFilter:[],filterFn:(z,w)=>z.some(v=>-1!==w.priority.indexOf(v))},{i18n:"process.name",field:"processName"},{i18n:"process.computionFramework",field:"computionFrameworkZh"},{i18n:"job.runningVersion",field:"processVersion"},{i18n:"job.taskUrl",field:"trackUrl",render:"trackUrl"},{i18n:"base.creator",field:"creator"},{i18n:"base.createdTime",field:"createdTime"},{i18n:"base.lastModifiedTime",field:"lastModifiedTime"},{type:"operate",render:"optColumn"}],this.interactionColumns=[{type:"checkbox"},{type:"index"},{i18n:"base.name",field:"name"},{i18n:"job.priority",field:"priorityZh",filterMultiple:!0,listOfFilter:[],filterFn:(z,w)=>z.some(v=>-1!==w.priority.indexOf(v))},{i18n:"process.name",field:"processName"},{i18n:"process.computionFramework",field:"computionFrameworkZh"},{i18n:"job.runningVersion",field:"processVersion"},{i18n:"job.taskUrl",field:"trackUrl",render:"trackUrl2"},{i18n:"base.creator",field:"creator"},{i18n:"base.createdTime",field:"createdTime"},{i18n:"base.lastModifiedTime",field:"lastModifiedTime"},{type:"operate",render:"optColumn2"}],this.eventColumns=[{type:"checkbox"},{type:"index"},{i18n:"base.name",field:"name"},{i18n:"job.priority",field:"priorityZh",filterMultiple:!0,listOfFilter:[],filterFn:(z,w)=>z.some(v=>-1!==w.priority.indexOf(v))},{i18n:"process.name",field:"processName"},{i18n:"process.computionFramework",field:"computionFrameworkZh"},{i18n:"job.runningVersion",field:"processVersion"},{i18n:"job.taskUrl",field:"trackUrl",render:"trackUrl1"},{i18n:"base.creator",field:"creator"},{i18n:"base.createdTime",field:"createdTime"},{i18n:"base.lastModifiedTime",field:"lastModifiedTime"},{type:"operate",render:"optColumn1"}],this.contentStyle={height:"calc(100% - 32px)"},this.selectedIndex=0,this.schedulerPage={pageIndex:1,pageSize:10,total:0},this.eventPage={pageIndex:1,pageSize:10,total:0},this.interactionPage={pageIndex:1,pageSize:10,total:0},this.jobVariableVisible=!1}ngOnInit(){this.processId&&(this.contentStyle={height:"calc(100% - 25px)",padding:"0 15px 15px"}),this.columns[3].listOfFilter=u.Y.map(e=>({text:e.label,value:e.value})),this.eventColumns[3].listOfFilter=u.Y.map(e=>({text:e.label,value:e.value})),this.prcApi.getComputionFrameworkList().subscribe(e=>{this.computionFrameworkData=e,this.mappingAlias(this.schedulerJobListData),this.mappingAlias(this.eventJobListData),this.mappingAlias(this.interactionJobListData)})}ngOnChanges(e){this.schedulerJobList(),this.eventJobList(),this.interactionJobList()}refresh(){0===this.selectedIndex?this.taskList.refresh():1===this.selectedIndex?this.schedulerJobList():2===this.selectedIndex?this.interactionJobList():this.eventJobList()}schedulerJobList(e=!1){this.processId?this.api.getJobList(this.processId,"SCHEDULER",this.schedulerPage.pageIndex,this.schedulerPage.pageSize).subscribe(o=>{this.schedulerJobListData=o.content,this.mappingAlias(this.schedulerJobListData),this.schedulerPage.total=o.totalElements,e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):this.groupId?this.api.getJobListByGroup(this.groupId,"SCHEDULER",this.schedulerPage.pageIndex,this.schedulerPage.pageSize).subscribe(o=>{this.schedulerJobListData=o.content,this.mappingAlias(this.schedulerJobListData),this.schedulerPage.total=o.totalElements,e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):(this.schedulerJobListData=null,this.schedulerPage.total=0)}eventJobList(e=!1){this.processId?this.api.getJobList(this.processId,"EVENT",this.eventPage.pageIndex,this.eventPage.pageSize).subscribe(o=>{this.eventJobListData=o.content,this.mappingAlias(this.eventJobListData),this.eventPage.total=o.totalElements,e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):this.groupId?this.api.getJobListByGroup(this.groupId,"EVENT",this.eventPage.pageIndex,this.eventPage.pageSize).subscribe(o=>{this.eventJobListData=o.content,this.mappingAlias(this.eventJobListData),this.eventPage.total=o.totalElements,e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):(this.eventJobListData=null,this.eventPage.total=0)}interactionJobList(e=!1){this.processId?this.api.getJobList(this.processId,"INTERACTION",this.interactionPage.pageIndex,this.interactionPage.pageSize).subscribe(o=>{this.interactionJobListData=o.content,this.mappingAlias(this.interactionJobListData),this.interactionPage.total=o.totalElements,e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):this.groupId?this.api.getJobListByGroup(this.groupId,"INTERACTION",this.interactionPage.pageIndex,this.interactionPage.pageSize).subscribe(o=>{this.interactionJobListData=o.content,this.mappingAlias(this.interactionJobListData),this.interactionPage.total=o.totalElements,e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):(this.interactionJobListData=null,this.interactionPage.total=0)}mappingAlias(e){!e||!this.computionFrameworkData||e.map(o=>{var l,s;o.priorityZh=null===(l=u.Y.find(g=>g.value===o.priority))||void 0===l?void 0:l.label,o.computionFrameworkZh=null===(s=this.computionFrameworkData.find(g=>g.name===o.computionFramework))||void 0===s?void 0:s.alias})}pageChangeHandler(e,o){this[`${o}Page`].pageIndex=e.pageIndex,this[`${o}Page`].pageSize=e.pageSize,this[`${o}JobList`]()}enableJob(e){this.api.enableJob(e.id,!e.enabled).subscribe(o=>{e.enabled=!e.enabled})}runJob(e){!e.enabled||(this.selectedJob=e,this.api.getMergeVariables(e.id,e.processGraphMementoId).subscribe(o=>{(null==o?void 0:o.length)?(this.jobVariableData=o,this.jobVariableVisible=!0):this.runEventJob(e)}))}runEventJob(e){!e.enabled||this.api.runJob(e.id).subscribe(o=>{this.message.success("\u6267\u884c\u547d\u4ee4\u4e0b\u53d1\u6210\u529f!")})}stopJob(e){!e.enabled||this.api.stopJob(e.id).subscribe(o=>{this.message.success("\u505c\u6b62\u547d\u4ee4\u4e0b\u53d1\u6210\u529f!")})}deleteConfirm(e,o){this.api.deleteJob(e.id).subscribe(l=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this[`${o}JobList`]()})}batchDelete(e){this.deleteSer.open().then(()=>{this.api.deleteJob(this.schedulerJobListData.filter(o=>o.selected).map(o=>o.id).join(",")).subscribe(o=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this.schedulerTable.checked=this.schedulerTable.indeterminate=!1,this[`${e}JobList`]()})})}onReturn(){this.router.navigate(["/process"])}addJob(e){let o="";const l={type:e};this.groupId?(l.groupId=this.groupId,o="/job/add"):this.processId&&(l.processId=this.processId,o=this.isProgram?"/process/program/job/add":"/process/job/add"),this.router.navigate([o],{queryParams:l})}editJob(e,o){let l="";const s={type:e};this.groupId?(s.groupId=this.groupId,l="/job/edit/"):this.processId&&(s.processId=this.processId,l=this.isProgram?"/process/program/job/edit/":"/process/job/edit/"),this.router.navigate([`${l}${o.id}`],{queryParams:s})}onOk(){this.api.runJob(this.selectedJob.id,this.jobVariable.getMapOfVariables()).subscribe(e=>{this.message.success("\u6267\u884c\u547d\u4ee4\u4e0b\u53d1\u6210\u529f!"),this.jobVariableVisible=!1})}onCancel(){this.jobVariableVisible=!1}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(O.k5),t.Y36(O.DQ),t.Y36(k.dD),t.Y36(P.wi),t.Y36(b.F0),t.Y36(f.nB))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-job-list"]],viewQuery:function(e,o){if(1&e&&(t.Gf(U,5),t.Gf(d,5),t.Gf(C,5)),2&e){let l;t.iGM(l=t.CRH())&&(o.taskList=l.first),t.iGM(l=t.CRH())&&(o.schedulerTable=l.first),t.iGM(l=t.CRH())&&(o.jobVariable=l.first)}},inputs:{processId:"processId",isProgram:"isProgram",groupId:"groupId",selectedGroup:"selectedGroup"},features:[t.TTD],decls:11,vars:12,consts:[[1,"layout","pr"],["dy-icon","","type","return","class","pa",3,"nz-tooltip","click",4,"ngIf"],[3,"selectedIndex","selectedIndexChange"],[3,"alias",4,"authx"],["class","modal pa",4,"ngIf"],[3,"nzVisible","nzTitle","nzWidth","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],["dy-icon","","type","return",1,"pa",3,"nz-tooltip","click"],[3,"alias"],[1,"tab-content","pr",3,"ngStyle"],[1,"toolbar"],["resAuthx","",3,"behavior","rawData","irrelevantRawData"],["dy-icon","","type","refresh",3,"nz-tooltip","click"],[1,"job-box"],[3,"groupId","processId"],["taskList",""],["dy-icon","","type","xinzeng",3,"nz-tooltip","click"],["dy-icon","","type","piliangshanchu",3,"disabled","nz-tooltip","click"],["searchField","name",3,"columns","data","total","pageIndex","pageSize","pageChange"],["schedulerTable",""],["dy-column","optColumn"],["dy-column","trackUrl"],["dy-icon","","type","eye",3,"nz-tooltip","click"],["dy-icon","","type","xiugai",3,"nz-tooltip","click"],["dy-icon","","type","yunhang",3,"disabled","nz-tooltip","click"],["nzSize","small","nzCheckedChildren","\u7981\u7528","nzUnCheckedChildren","\u542f\u7528",3,"ngModel","nzControl","click"],["dy-icon","","type","shanchu","nz-popconfirm","",3,"nzPopconfirmTitle","nz-tooltip","nzOnConfirm"],["target","_blank",3,"href"],["interactionTable",""],["dy-column","optColumn2"],["dy-column","trackUrl2"],["eventTable",""],["dy-column","optColumn1"],["dy-column","trackUrl1"],[1,"modal","pa"],[3,"info","jobId","lookLog","onReturn"],[3,"variableData"],["jobVariable",""]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.YNc(1,i,2,3,"i",1),t.TgZ(2,"dy-tabs",2),t.NdJ("selectedIndexChange",function(s){return o.selectedIndex=s}),t.YNc(3,m,12,15,"dy-tab",3),t.YNc(4,L,14,18,"dy-tab",3),t.YNc(5,W,14,18,"dy-tab",3),t.YNc(6,tt,14,18,"dy-tab",3),t.qZA(),t.YNc(7,et,2,2,"div",4),t.qZA(),t.TgZ(8,"nz-modal",5),t.NdJ("nzVisibleChange",function(s){return o.jobVariableVisible=s})("nzOnCancel",function(){return o.onCancel()})("nzOnOk",function(){return o.onOk()}),t.ALo(9,"nzI18n"),t.YNc(10,nt,3,1,"ng-container",6),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",o.processId),t.xp6(1),t.Q6J("selectedIndex",o.selectedIndex),t.xp6(1),t.Q6J("authx","Job.List.Immediate"),t.xp6(1),t.Q6J("authx","Job.List.Scheduler"),t.xp6(1),t.Q6J("authx","Job.List.Interaction"),t.xp6(1),t.Q6J("authx","Job.List.Event"),t.xp6(1),t.Q6J("ngIf",o.currentJob),t.xp6(1),t.Q6J("nzVisible",o.jobVariableVisible)("nzTitle",t.lcZ(9,10,"base.variable"))("nzWidth",450))},directives:[h.O5,f.kE,M.SY,A.N,f.RG,I.xo,f.MR,h.PC,I.Ud,Z.n,N.a,Q.rA,j.i,E.JJ,E.On,F.JW,D.du,D.Hf,B.$],pipes:[P.o9],styles:["html.default[_ngcontent-%COMP%]   html[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   body[_ngcontent-%COMP%]{min-width:1366px}html.default[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   dl[_ngcontent-%COMP%]{margin:0;padding:0;list-style:none}html.default[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin:0}html.default[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;flex:auto;flex-direction:column}html.default[_ngcontent-%COMP%]   .fdc[_ngcontent-%COMP%]{flex-direction:column}html.default[_ngcontent-%COMP%]   .fdr[_ngcontent-%COMP%]{flex-direction:row}html.default[_ngcontent-%COMP%]   .fauto[_ngcontent-%COMP%]{flex:auto}html.default[_ngcontent-%COMP%]   .pf[_ngcontent-%COMP%]{position:fixed}html.default[_ngcontent-%COMP%]   .pr[_ngcontent-%COMP%]{position:relative}html.default[_ngcontent-%COMP%]   .pa[_ngcontent-%COMP%]{position:absolute}html.default[_ngcontent-%COMP%]   .fl[_ngcontent-%COMP%]{float:left}html.default[_ngcontent-%COMP%]   .fr[_ngcontent-%COMP%]{float:right}html.default[_ngcontent-%COMP%]   .clear-f[_ngcontent-%COMP%]{clear:both}html.default[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#396669}html.default[_ngcontent-%COMP%]   .ant-table-pagination.ant-pagination[_ngcontent-%COMP%]{margin:0}html.default[_ngcontent-%COMP%]   .ant-pagination[_ngcontent-%COMP%]{text-align:right}html.default[_ngcontent-%COMP%]   .ant-table-column-sorter[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-table-filter-trigger[_ngcontent-%COMP%]{color:#a1a1a1}html.default[_ngcontent-%COMP%]   .ant-table-filter-trigger.active[_ngcontent-%COMP%]{color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-table-thead[_ngcontent-%COMP%]   th.ant-table-column-sort[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-table-thead[_ngcontent-%COMP%]   th.ant-table-column-has-sorters[_ngcontent-%COMP%]:hover{background:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-tree-switcher[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-tree-indent-unit[_ngcontent-%COMP%]{width:17px;color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-tree[_ngcontent-%COMP%]   .ant-tree-node-content-wrapper[_ngcontent-%COMP%]{padding:0}html.default[_ngcontent-%COMP%]   .ant-tree-checkbox-inner[_ngcontent-%COMP%]{display:inline-block}html.default[_ngcontent-%COMP%]   .ant-select-tree[_ngcontent-%COMP%]   .ant-select-tree-node-content-wrapper.ant-select-tree-node-selected[_ngcontent-%COMP%]:hover{background-color:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-modal-title[_ngcontent-%COMP%]{color:#396669}html.default[_ngcontent-%COMP%]   .ant-dropdown-menu-item-selected[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-dropdown-menu-submenu-title-selected[_ngcontent-%COMP%]{background-color:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-badge-status-processing[_ngcontent-%COMP%]{background-color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-badge-status-processing[_ngcontent-%COMP%]:after{border-color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-tooltip[_ngcontent-%COMP%]{max-width:550px;max-height:550px;overflow:hidden}html.default[_ngcontent-%COMP%]   .ant-tooltip-content[_ngcontent-%COMP%]{width:100%;height:100%;max-width:550px;max-height:542px}html.default[_ngcontent-%COMP%]   .ant-tooltip-inner[_ngcontent-%COMP%]{box-shadow:none}html.default[_ngcontent-%COMP%]   .ant-tooltip.replicable[_ngcontent-%COMP%]   .ant-tooltip-inner[_ngcontent-%COMP%]{display:flex;overflow:hidden;padding-right:3px}html.default[_ngcontent-%COMP%]   .ant-tooltip.replicable[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{overflow:auto}html.default[_ngcontent-%COMP%]   .ant-tooltip.replicable[_ngcontent-%COMP%]   .copy-box[_ngcontent-%COMP%]{height:20px;position:relative;top:-7px}html.default[_ngcontent-%COMP%]   .ant-tooltip.replicable[_ngcontent-%COMP%]   .copy-box[_ngcontent-%COMP%]   .ic-fuzhi[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-tooltip.replicable[_ngcontent-%COMP%]   .copy-box[_ngcontent-%COMP%]   .ic-check[_ngcontent-%COMP%]{font-size:20px}html.default[_ngcontent-%COMP%]   .ant-tooltip.replicable[_ngcontent-%COMP%]   .copy-box[_ngcontent-%COMP%]   .ic-fuzhi[_ngcontent-%COMP%]:hover, html.default[_ngcontent-%COMP%]   .ant-tooltip.replicable[_ngcontent-%COMP%]   .copy-box[_ngcontent-%COMP%]   .ic-check[_ngcontent-%COMP%]:hover{color:#c4c4c4}html.default   [_nghost-%COMP%]   .ic-return[_ngcontent-%COMP%]{right:15px;top:-9px}html.default   [_nghost-%COMP%]   .job-box[_ngcontent-%COMP%]{width:100%;height:calc(100% - 45px);overflow:auto}html.default   [_nghost-%COMP%]     .app-table td i{margin-right:5px;font-size:22px}html.default   [_nghost-%COMP%]     .app-table td i.ic-chakanrizhi1, html.default   [_nghost-%COMP%]     .app-table td i.ic-chakanzhuangtai1, html.default   [_nghost-%COMP%]     .app-table td i.ic-chakanshuju1{font-size:16px;margin-right:7px}html.default   [_nghost-%COMP%]     .app-table td i.ic-yunhang, html.default   [_nghost-%COMP%]     .app-table td i.ic-stop{font-size:18px}html.default   [_nghost-%COMP%]     .app-table td i.ic-yunhang{margin-left:3px;margin-top:1px}html.default   [_nghost-%COMP%]     .app-table td i.ic-xiugai{margin-right:0}html.default   [_nghost-%COMP%]     .app-table td i.disabled{opacity:.5;cursor:not-allowed}html.default   [_nghost-%COMP%]     .app-table td.operation-column{display:flex;justify-content:center;align-items:center}html.default   [_nghost-%COMP%]     .app-table td a{display:inline-block;overflow:hidden;word-break:keep-all;text-overflow:ellipsis;white-space:nowrap;max-width:200px}html.default   [_nghost-%COMP%]     .app-table nz-switch{position:relative;bottom:2px;white-space:nowrap}html.default   [_nghost-%COMP%]   .modal[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#fbffff;z-index:2}html.dark   [_nghost-%COMP%]   .ic-return[_ngcontent-%COMP%]{right:15px;top:-9px}html.dark   [_nghost-%COMP%]   .job-box[_ngcontent-%COMP%]{width:100%;height:calc(100% - 45px);overflow:auto}html.dark   [_nghost-%COMP%]     .app-table td i{margin-right:5px;font-size:22px}html.dark   [_nghost-%COMP%]     .app-table td i.ic-chakanrizhi1, html.dark   [_nghost-%COMP%]     .app-table td i.ic-chakanzhuangtai1, html.dark   [_nghost-%COMP%]     .app-table td i.ic-chakanshuju1{font-size:16px;margin-right:7px}html.dark   [_nghost-%COMP%]     .app-table td i.ic-yunhang, html.dark   [_nghost-%COMP%]     .app-table td i.ic-stop{font-size:18px}html.dark   [_nghost-%COMP%]     .app-table td i.ic-yunhang{margin-left:3px;margin-top:1px}html.dark   [_nghost-%COMP%]     .app-table td i.ic-xiugai{margin-right:0}html.dark   [_nghost-%COMP%]     .app-table td i.disabled{opacity:.5;cursor:not-allowed}html.dark   [_nghost-%COMP%]     .app-table td.operation-column{display:flex;justify-content:center;align-items:center}html.dark   [_nghost-%COMP%]     .app-table td a{display:inline-block;overflow:hidden;word-break:keep-all;text-overflow:ellipsis;white-space:nowrap;max-width:200px}html.dark   [_nghost-%COMP%]     .app-table nz-switch{position:relative;bottom:2px;white-space:nowrap}html.dark   [_nghost-%COMP%]   .modal[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#fbfcff;z-index:2}html.light-blue   [_nghost-%COMP%]   .ic-return[_ngcontent-%COMP%]{right:15px;top:-9px}html.light-blue   [_nghost-%COMP%]   .job-box[_ngcontent-%COMP%]{width:100%;height:calc(100% - 45px);overflow:auto}html.light-blue   [_nghost-%COMP%]     .app-table td i{margin-right:5px;font-size:22px}html.light-blue   [_nghost-%COMP%]     .app-table td i.ic-chakanrizhi1, html.light-blue   [_nghost-%COMP%]     .app-table td i.ic-chakanzhuangtai1, html.light-blue   [_nghost-%COMP%]     .app-table td i.ic-chakanshuju1{font-size:16px;margin-right:7px}html.light-blue   [_nghost-%COMP%]     .app-table td i.ic-yunhang, html.light-blue   [_nghost-%COMP%]     .app-table td i.ic-stop{font-size:18px}html.light-blue   [_nghost-%COMP%]     .app-table td i.ic-yunhang{margin-left:3px;margin-top:1px}html.light-blue   [_nghost-%COMP%]     .app-table td i.ic-xiugai{margin-right:0}html.light-blue   [_nghost-%COMP%]     .app-table td i.disabled{opacity:.5;cursor:not-allowed}html.light-blue   [_nghost-%COMP%]     .app-table td.operation-column{display:flex;justify-content:center;align-items:center}html.light-blue   [_nghost-%COMP%]     .app-table td a{display:inline-block;overflow:hidden;word-break:keep-all;text-overflow:ellipsis;white-space:nowrap;max-width:200px}html.light-blue   [_nghost-%COMP%]     .app-table nz-switch{position:relative;bottom:2px;white-space:nowrap}html.light-blue   [_nghost-%COMP%]   .modal[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#fff;z-index:2}html.dark-blue   [_nghost-%COMP%]   .ic-return[_ngcontent-%COMP%]{right:15px;top:-9px}html.dark-blue   [_nghost-%COMP%]   .job-box[_ngcontent-%COMP%]{width:100%;height:calc(100% - 45px);overflow:auto}html.dark-blue   [_nghost-%COMP%]     .app-table td i{margin-right:5px;font-size:22px}html.dark-blue   [_nghost-%COMP%]     .app-table td i.ic-chakanrizhi1, html.dark-blue   [_nghost-%COMP%]     .app-table td i.ic-chakanzhuangtai1, html.dark-blue   [_nghost-%COMP%]     .app-table td i.ic-chakanshuju1{font-size:16px;margin-right:7px}html.dark-blue   [_nghost-%COMP%]     .app-table td i.ic-yunhang, html.dark-blue   [_nghost-%COMP%]     .app-table td i.ic-stop{font-size:18px}html.dark-blue   [_nghost-%COMP%]     .app-table td i.ic-yunhang{margin-left:3px;margin-top:1px}html.dark-blue   [_nghost-%COMP%]     .app-table td i.ic-xiugai{margin-right:0}html.dark-blue   [_nghost-%COMP%]     .app-table td i.disabled{opacity:.5;cursor:not-allowed}html.dark-blue   [_nghost-%COMP%]     .app-table td.operation-column{display:flex;justify-content:center;align-items:center}html.dark-blue   [_nghost-%COMP%]     .app-table td a{display:inline-block;overflow:hidden;word-break:keep-all;text-overflow:ellipsis;white-space:nowrap;max-width:200px}html.dark-blue   [_nghost-%COMP%]     .app-table nz-switch{position:relative;bottom:2px;white-space:nowrap}html.dark-blue   [_nghost-%COMP%]   .modal[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#091a2a;z-index:2}html.blue1   [_nghost-%COMP%]   .ic-return[_ngcontent-%COMP%]{right:15px;top:-9px}html.blue1   [_nghost-%COMP%]   .job-box[_ngcontent-%COMP%]{width:100%;height:calc(100% - 45px);overflow:auto}html.blue1   [_nghost-%COMP%]     .app-table td i{margin-right:5px;font-size:22px}html.blue1   [_nghost-%COMP%]     .app-table td i.ic-chakanrizhi1, html.blue1   [_nghost-%COMP%]     .app-table td i.ic-chakanzhuangtai1, html.blue1   [_nghost-%COMP%]     .app-table td i.ic-chakanshuju1{font-size:16px;margin-right:7px}html.blue1   [_nghost-%COMP%]     .app-table td i.ic-yunhang, html.blue1   [_nghost-%COMP%]     .app-table td i.ic-stop{font-size:18px}html.blue1   [_nghost-%COMP%]     .app-table td i.ic-yunhang{margin-left:3px;margin-top:1px}html.blue1   [_nghost-%COMP%]     .app-table td i.ic-xiugai{margin-right:0}html.blue1   [_nghost-%COMP%]     .app-table td i.disabled{opacity:.5;cursor:not-allowed}html.blue1   [_nghost-%COMP%]     .app-table td.operation-column{display:flex;justify-content:center;align-items:center}html.blue1   [_nghost-%COMP%]     .app-table td a{display:inline-block;overflow:hidden;word-break:keep-all;text-overflow:ellipsis;white-space:nowrap;max-width:200px}html.blue1   [_nghost-%COMP%]     .app-table nz-switch{position:relative;bottom:2px;white-space:nowrap}html.blue1   [_nghost-%COMP%]   .modal[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#fff;z-index:2}"],data:{animation:[n.MC]}}),a})()},64085:(R,J,r)=>{r.d(J,{$:()=>P});var n=r(24670),u=r(5e3),t=r(69808),O=r(96525);function k(b,f){1&b&&u._UZ(0,"compox-factory",1),2&b&&u.Q6J("parameter",f.$implicit.parameter)}let P=(()=>{class b{constructor(){}ngOnInit(){this.variables=this.variableData.filter(h=>"PLACEHOLDER"===h.variableType).map(h=>{const M=(new n._).initWithJsonData(h);return M.parameter.alias=h.alias,M})}getMapOfVariables(){const h={};return this.variables.map(M=>{h[M.name]=M.parameter.value}),h}}return b.\u0275fac=function(h){return new(h||b)},b.\u0275cmp=u.Xpm({type:b,selectors:[["app-job-variable"]],inputs:{variableData:"variableData"},decls:1,vars:1,consts:[[3,"parameter",4,"ngFor","ngForOf"],[3,"parameter"]],template:function(h,M){1&h&&u.YNc(0,k,1,1,"compox-factory",0),2&h&&u.Q6J("ngForOf",M.variables)},directives:[t.sg,O._],styles:["html.default[_ngcontent-%COMP%]   html[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   body[_ngcontent-%COMP%]{min-width:1366px}html.default[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   dl[_ngcontent-%COMP%]{margin:0;padding:0;list-style:none}html.default[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin:0}html.default[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;flex:auto;flex-direction:column}html.default[_ngcontent-%COMP%]   .fdc[_ngcontent-%COMP%]{flex-direction:column}html.default[_ngcontent-%COMP%]   .fdr[_ngcontent-%COMP%]{flex-direction:row}html.default[_ngcontent-%COMP%]   .fauto[_ngcontent-%COMP%]{flex:auto}html.default[_ngcontent-%COMP%]   .pf[_ngcontent-%COMP%]{position:fixed}html.default[_ngcontent-%COMP%]   .pr[_ngcontent-%COMP%]{position:relative}html.default[_ngcontent-%COMP%]   .pa[_ngcontent-%COMP%]{position:absolute}html.default[_ngcontent-%COMP%]   .fl[_ngcontent-%COMP%]{float:left}html.default[_ngcontent-%COMP%]   .fr[_ngcontent-%COMP%]{float:right}html.default[_ngcontent-%COMP%]   .clear-f[_ngcontent-%COMP%]{clear:both}html.default[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#396669}html.default[_ngcontent-%COMP%]   .ant-table-pagination.ant-pagination[_ngcontent-%COMP%]{margin:0}html.default[_ngcontent-%COMP%]   .ant-pagination[_ngcontent-%COMP%]{text-align:right}html.default[_ngcontent-%COMP%]   .ant-table-column-sorter[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-table-filter-trigger[_ngcontent-%COMP%]{color:#a1a1a1}html.default[_ngcontent-%COMP%]   .ant-table-filter-trigger.active[_ngcontent-%COMP%]{color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-table-thead[_ngcontent-%COMP%]   th.ant-table-column-sort[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-table-thead[_ngcontent-%COMP%]   th.ant-table-column-has-sorters[_ngcontent-%COMP%]:hover{background:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-tree-switcher[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-tree-indent-unit[_ngcontent-%COMP%]{width:17px;color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-tree[_ngcontent-%COMP%]   .ant-tree-node-content-wrapper[_ngcontent-%COMP%]{padding:0}html.default[_ngcontent-%COMP%]   .ant-tree-checkbox-inner[_ngcontent-%COMP%]{display:inline-block}html.default[_ngcontent-%COMP%]   .ant-select-tree[_ngcontent-%COMP%]   .ant-select-tree-node-content-wrapper.ant-select-tree-node-selected[_ngcontent-%COMP%]:hover{background-color:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-modal-title[_ngcontent-%COMP%]{color:#396669}html.default[_ngcontent-%COMP%]   .ant-dropdown-menu-item-selected[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-dropdown-menu-submenu-title-selected[_ngcontent-%COMP%]{background-color:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-badge-status-processing[_ngcontent-%COMP%]{background-color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-badge-status-processing[_ngcontent-%COMP%]:after{border-color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-tooltip[_ngcontent-%COMP%]{max-width:550px;max-height:550px;overflow:hidden}html.default[_ngcontent-%COMP%]   .ant-tooltip-content[_ngcontent-%COMP%]{width:100%;height:100%;max-width:550px;max-height:542px}html.default[_ngcontent-%COMP%]   .ant-tooltip-inner[_ngcontent-%COMP%]{box-shadow:none}html.default[_ngcontent-%COMP%]   .ant-tooltip.replicable[_ngcontent-%COMP%]   .ant-tooltip-inner[_ngcontent-%COMP%]{display:flex;overflow:hidden;padding-right:3px}html.default[_ngcontent-%COMP%]   .ant-tooltip.replicable[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{overflow:auto}html.default[_ngcontent-%COMP%]   .ant-tooltip.replicable[_ngcontent-%COMP%]   .copy-box[_ngcontent-%COMP%]{height:20px;position:relative;top:-7px}html.default[_ngcontent-%COMP%]   .ant-tooltip.replicable[_ngcontent-%COMP%]   .copy-box[_ngcontent-%COMP%]   .ic-fuzhi[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-tooltip.replicable[_ngcontent-%COMP%]   .copy-box[_ngcontent-%COMP%]   .ic-check[_ngcontent-%COMP%]{font-size:20px}html.default[_ngcontent-%COMP%]   .ant-tooltip.replicable[_ngcontent-%COMP%]   .copy-box[_ngcontent-%COMP%]   .ic-fuzhi[_ngcontent-%COMP%]:hover, html.default[_ngcontent-%COMP%]   .ant-tooltip.replicable[_ngcontent-%COMP%]   .copy-box[_ngcontent-%COMP%]   .ic-check[_ngcontent-%COMP%]:hover{color:#c4c4c4}html.default   [_nghost-%COMP%]     i{display:none}html.dark   [_nghost-%COMP%]     i{display:none}html.light-blue   [_nghost-%COMP%]     i{display:none}html.dark-blue   [_nghost-%COMP%]     i{display:none}html.blue1   [_nghost-%COMP%]     i{display:none}"]}),b})()},18393:(R,J,r)=>{r.d(J,{n:()=>U});var n=r(5e3),u=r(46055),t=r(90056),O=r(77152),k=r(49727),P=r(89445),b=r(91156),f=r(69808),h=r(404),M=r(91984),A=r(72394),I=r(55535),Z=r(49841);const N=["table"];function Q(d,C){if(1&d){const i=n.EpF();n.TgZ(0,"div",6),n._uU(1),n.TgZ(2,"span")(3,"i",7),n.NdJ("click",function(){return n.CHM(i),n.oxw().batchDelete()}),n.ALo(4,"nzI18n"),n.qZA(),n.TgZ(5,"i",8),n.NdJ("click",function(){return n.CHM(i),n.oxw().onReturn.emit()}),n.qZA()()()}if(2&d){const i=n.oxw(),c=n.MAs(3);n.xp6(1),n.hij(" ",i.info," "),n.xp6(2),n.Q6J("fontsize",24)("disabled",!c.checked&&!c.indeterminate)("nz-tooltip",n.lcZ(4,4,"BatchDelete.title"))}}function j(d,C){if(1&d&&(n.TgZ(0,"a",9),n._uU(1),n.qZA()),2&d){const i=C.$implicit;n.Q6J("href",i.trackUrl,n.LSH),n.xp6(1),n.Oqu(i.trackUrl)}}function E(d,C){if(1&d){const i=n.EpF();n.ynx(0),n.TgZ(1,"div",12)(2,"i",13),n.NdJ("click",function(){n.CHM(i);const p=n.oxw().$implicit;return n.oxw().lookDebugDataHandler(p)}),n.qZA(),n.TgZ(3,"i",14),n.NdJ("nzOnConfirm",function(){n.CHM(i);const p=n.oxw().$implicit;return n.oxw().deleteConfirm(p)}),n.ALo(4,"nzI18n"),n.ALo(5,"nzI18n"),n.ALo(6,"nzI18n"),n.qZA()(),n.BQk()}2&d&&(n.xp6(2),n.Q6J("fontsize",16)("nz-tooltip","\u67e5\u770b\u6570\u636e"),n.xp6(1),n.Q6J("nzPopconfirmTitle",n.lcZ(4,4,"base.confirmDel")+n.lcZ(5,6,"menu.job")+"?")("nz-tooltip",n.lcZ(6,8,"base.delete")))}function F(d,C){if(1&d){const i=n.EpF();n.TgZ(0,"i",20),n.NdJ("click",function(){n.CHM(i);const p=n.oxw(2).$implicit;return n.oxw().lookDataHandler(p,"task")}),n.qZA()}2&d&&n.Q6J("nz-tooltip","\u67e5\u770b\u5173\u8054\u5b50\u4efb\u52a1")("fontsize",18)}function D(d,C){if(1&d){const i=n.EpF();n.TgZ(0,"i",15),n.NdJ("click",function(){n.CHM(i);const p=n.oxw().$implicit;return n.oxw().lookDataHandler(p,"log")}),n.qZA(),n.TgZ(1,"i",16),n.NdJ("click",function(){n.CHM(i);const p=n.oxw().$implicit;return n.oxw().lookDataHandler(p)}),n.qZA(),n.YNc(2,F,1,2,"i",17),n.TgZ(3,"i",18),n.NdJ("click",function(){n.CHM(i);const p=n.oxw().$implicit;return n.oxw().lookDataHandler(p,"result")}),n.qZA(),n.TgZ(4,"i",19),n.NdJ("click",function(){n.CHM(i);const p=n.oxw().$implicit;return n.oxw().stopHandler(p)}),n.qZA(),n.TgZ(5,"i",14),n.NdJ("nzOnConfirm",function(){n.CHM(i);const p=n.oxw().$implicit;return n.oxw().deleteConfirm(p)}),n.ALo(6,"nzI18n"),n.ALo(7,"nzI18n"),n.ALo(8,"nzI18n"),n.qZA()}if(2&d){const i=n.oxw().$implicit;n.Q6J("nz-tooltip","\u67e5\u770b\u65e5\u5fd7"),n.xp6(1),n.Q6J("nz-tooltip","\u67e5\u770b\u72b6\u6001"),n.xp6(1),n.Q6J("ngIf","JOBCTRL"===i.graphType),n.xp6(1),n.Q6J("disabled","FINISHED"!==i.state)("nz-tooltip","\u67e5\u770b\u6570\u636e"),n.xp6(1),n.Q6J("disabled","RUNNING"!==i.state&&"QUEUING"!==i.state)("nz-tooltip","\u7ed3\u675f")("fontsize",17),n.xp6(1),n.Q6J("nzPopconfirmTitle",n.lcZ(6,10,"base.confirmDel")+n.lcZ(7,12,"menu.job")+"?")("nz-tooltip",n.lcZ(8,14,"base.delete"))}}function B(d,C){if(1&d&&(n.YNc(0,E,7,10,"ng-container",10),n.YNc(1,D,9,16,"ng-template",null,11,n.W1O)),2&d){const i=n.MAs(2),c=n.oxw();n.Q6J("ngIf",c.taskList)("ngIfElse",i)}}let U=(()=>{class d{constructor(i,c,p,m,x,H){this.api=i,this.prcApi=c,this.router=p,this.message=m,this.i18n=x,this.deleteSer=H,this.onReturn=new n.vpe,this.lookDebugData=new n.vpe,this.page={pageIndex:1,pageSize:10,total:0},this.columns=[{type:"checkbox"},{type:"index"},{i18n:"process.name",field:"processName"},{i18n:"process.computionFramework",field:"computionFrameworkZh"},{i18n:"process.versionType",field:"processVersionTypeZh",filterMultiple:!0,listOfFilter:[],filterFn:(T,y)=>T.some(L=>-1!==y.processVersionType.indexOf(L))},{i18n:"job.runningVersion",field:"processVersion"},{i18n:"base.startTime",field:"runStartTime"},{i18n:"base.endTime",field:"runEndTime"},{i18n:"job.consuming",field:"duration"},{i18n:"base.status",field:"stateZh",filterMultiple:!0,listOfFilter:[],filterFn:(T,y)=>T.some(L=>-1!==y.state.indexOf(L))},{i18n:"job.taskUrl",render:"trackUrl"},{type:"operate",render:"opts"}]}ngOnInit(){this.columns[4].listOfFilter=u.IA.map(i=>({text:i.label,value:i.value})),this.columns[9].listOfFilter=u.hY.map(i=>({text:i.label,value:i.value})),this.prcApi.getComputionFrameworkList().subscribe(i=>{this.computionFrameworkData=i,this.mappingAlias()})}ngOnChanges(i){this.refresh()}refresh(i=!1){this.jobId?this.getTaskListByJobId(i):this.groupId?this.getTaskListByGroupId(i):this.processId?this.getTaskListByProcessId(i):this.taskList?(this.columns.splice(2,1,{i18n:"\u4f5c\u4e1a\u540d\u79f0",field:"jobName"}),this.data=this.taskList,this.mappingAlias(),this.page.total=0):(this.data=null,this.page.total=0)}getTaskListByJobId(i=!1){this.api.getJobTaskListByJob(this.jobId,this.page.pageIndex,this.page.pageSize).subscribe(c=>{this.data=c.content,this.mappingAlias(),this.page.total=c.totalElements,i&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)})}getTaskListByGroupId(i=!1){this.api.getJobTaskListByGroup(this.groupId,"IMMEDIATE",this.page.pageIndex,this.page.pageSize).subscribe(c=>{this.data=c.content,this.mappingAlias(),this.page.total=c.totalElements,i&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)})}getTaskListByProcessId(i=!1){this.api.getJobTaskList(this.processId,"IMMEDIATE",this.page.pageIndex,this.page.pageSize).subscribe(c=>{this.data=c.content,this.mappingAlias(),this.page.total=c.totalElements,i&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)})}mappingAlias(){!this.data||!this.computionFrameworkData||this.data.map(i=>{var c,p,m;i.stateZh=null===(c=u.hY.find(x=>x.value===i.state))||void 0===c?void 0:c.label,i.processVersionTypeZh=null===(p=u.IA.find(x=>x.value===i.processVersionType))||void 0===p?void 0:p.label,i.computionFrameworkZh=null===(m=this.computionFrameworkData.find(x=>x.name===i.computionFramework))||void 0===m?void 0:m.alias,i.duration=(i.duration/1e3).toFixed(0)+"s"})}pageChangeHandler(i){this.page.pageIndex=i.pageIndex,this.page.pageSize=i.pageSize,this.refresh()}deleteConfirm(i){this.api.deleteJobTask(i.id).subscribe(c=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this.refresh()})}batchDelete(){this.deleteSer.open().then(()=>{this.api.deleteJobTask(this.data.filter(i=>i.selected).map(i=>i.id).join(",")).subscribe(i=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this.table.checked=this.table.indeterminate=!1,this.refresh()})})}stopHandler(i){this.api.stopTask(i.id).subscribe(c=>{this.refresh()})}lookDebugDataHandler(i){this.lookDebugData.emit(i)}lookDataHandler(i,c="status"){this.router.navigate([`/job/result/${i.id}`],{queryParams:{processId:i.processId,type:c}})}}return d.\u0275fac=function(i){return new(i||d)(n.Y36(t.k5),n.Y36(t.DQ),n.Y36(O.F0),n.Y36(k.dD),n.Y36(P.wi),n.Y36(b.nB))},d.\u0275cmp=n.Xpm({type:d,selectors:[["app-task-list"]],viewQuery:function(i,c){if(1&i&&n.Gf(N,5),2&i){let p;n.iGM(p=n.CRH())&&(c.table=p.first)}},inputs:{info:"info",taskList:"taskList",jobId:"jobId",groupId:"groupId",processId:"processId"},outputs:{onReturn:"onReturn",lookDebugData:"lookDebugData"},features:[n.TTD],decls:6,vars:8,consts:[["class","bread-crumb",4,"ngIf"],[1,"table-box"],["searchField","processName",3,"columns","data","total","pageIndex","pageSize","pageChange"],["table",""],["dy-column","trackUrl"],["dy-column","opts"],[1,"bread-crumb"],["dy-icon","","type","piliangshanchu",3,"fontsize","disabled","nz-tooltip","click"],["dy-icon","","type","return",3,"click"],["target","_blank",3,"href"],[4,"ngIf","ngIfElse"],["optsTemp",""],[2,"display","flex","justify-content","center","align-items","center"],["dy-icon","","type","chakanshuju1",3,"fontsize","nz-tooltip","click"],["dy-icon","","type","shanchu","nz-popconfirm","",3,"nzPopconfirmTitle","nz-tooltip","nzOnConfirm"],["dy-icon","","type","chakanrizhi1",3,"nz-tooltip","click"],["dy-icon","","type","chakanzhuangtai1",3,"nz-tooltip","click"],["dy-icon","","type","renwuguanli",3,"nz-tooltip","fontsize","click",4,"ngIf"],["dy-icon","","type","chakanshuju1",3,"disabled","nz-tooltip","click"],["dy-icon","","type","stop",3,"disabled","nz-tooltip","fontsize","click"],["dy-icon","","type","renwuguanli",3,"nz-tooltip","fontsize","click"]],template:function(i,c){1&i&&(n.YNc(0,Q,6,6,"div",0),n.TgZ(1,"div",1)(2,"app-table",2,3),n.NdJ("pageChange",function(m){return c.pageChangeHandler(m)}),n.YNc(4,j,2,2,"ng-template",4),n.YNc(5,B,3,2,"ng-template",5),n.qZA()()),2&i&&(n.Q6J("ngIf",c.info),n.xp6(1),n.ekj("paddingTop",c.info),n.xp6(1),n.Q6J("columns",c.columns)("data",c.data)("total",c.page.total)("pageIndex",c.page.pageIndex)("pageSize",c.page.pageSize))},directives:[f.O5,b.kE,h.SY,M.N,A.a,I.rA,Z.JW],pipes:[P.o9],styles:[".table-box[_ngcontent-%COMP%]{height:100%;background-color:var(--body-background)}.table-box.paddingTop[_ngcontent-%COMP%]{padding-top:10px;height:calc(100% - 25px)}"]}),d})()}}]);