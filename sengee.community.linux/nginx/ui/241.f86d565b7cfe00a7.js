"use strict";(self.webpackChunksengee_ui=self.webpackChunksengee_ui||[]).push([[241],{42241:(j,y,c)=>{c.d(y,{Q:()=>K});var n=c(28076),b=c(34654),t=c(5e3),O=c(14581),I=c(49727),C=c(89445),k=c(77152),f=c(31453),J=c(69808),z=c(404),E=c(91984),T=c(62545),v=c(18393),w=c(72394),D=c(55535),A=c(6462),L=c(93075),Z=c(49841);const N=["taskList"],Q=["schedulerTable"];function p(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"i",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().goBack()}),t.ALo(1,"nzI18n"),t.qZA()}2&a&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.return"))}function u(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"i",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).addJob("immediate")}),t.ALo(1,"nzI18n"),t.qZA()}2&a&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.add"))}function i(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"i",15),t.NdJ("click",function(){return t.CHM(e),t.oxw(),t.MAs(11).batchDelete()}),t.ALo(1,"nzI18n"),t.qZA()}if(2&a){t.oxw();const e=t.MAs(11);t.Q6J("disabled",!(null!=e.table&&e.table.checked||null!=e.table&&e.table.indeterminate))("nz-tooltip",t.lcZ(1,2,"BatchDelete.title"))}}function l(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"dy-tab",6),t.ALo(1,"nzI18n"),t.TgZ(2,"div",7)(3,"div",8)(4,"span"),t.YNc(5,u,2,3,"ng-template",9),t.YNc(6,i,2,4,"ng-template",9),t.TgZ(7,"i",10),t.NdJ("click",function(){return t.CHM(e),t.MAs(11).refresh(!0)}),t.ALo(8,"nzI18n"),t.qZA()()(),t.TgZ(9,"div",11),t._UZ(10,"app-task-list",12,13),t.qZA()()()}if(2&a){const e=t.oxw();t.Q6J("alias",t.lcZ(1,11,"job.immediate")),t.xp6(2),t.Q6J("ngStyle",e.contentStyle),t.xp6(3),t.Q6J("behavior","job.create")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("behavior","job.batchDelete")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(8,13,"base.refresh")),t.xp6(3),t.Q6J("groupId",e.groupId)("processId",e.processId)}}function _(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"i",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).addJob("scheduler")}),t.ALo(1,"nzI18n"),t.qZA()}2&a&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.add"))}function g(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"i",15),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).batchDelete("scheduler")}),t.ALo(1,"nzI18n"),t.qZA()}if(2&a){t.oxw();const e=t.MAs(11);t.Q6J("disabled",!e.checked&&!e.indeterminate)("nz-tooltip",t.lcZ(1,2,"BatchDelete.title"))}}function m(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"i",20),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(2).currentJob=r}),t.qZA(),t.TgZ(1,"i",21),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(2).editJob("scheduler",r)}),t.ALo(2,"nzI18n"),t.qZA(),t.TgZ(3,"i",22),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(2).runJob(r)}),t.qZA(),t.TgZ(4,"i")(5,"nz-switch",23),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(2).enableJob(r)}),t.qZA()(),t.TgZ(6,"i",24),t.NdJ("nzOnConfirm",function(){const r=t.CHM(e).$implicit;return t.oxw(2).deleteConfirm(r,"scheduler")}),t.ALo(7,"nzI18n"),t.ALo(8,"nzI18n"),t.ALo(9,"nzI18n"),t.qZA()}if(2&a){const e=d.$implicit;t.Q6J("nz-tooltip","\u67e5\u770b\u4efb\u52a1\u5217\u8868"),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(2,8,"base.edit")),t.xp6(2),t.Q6J("disabled",!e.enabled)("nz-tooltip","\u7acb\u5373\u6267\u884c"),t.xp6(2),t.Q6J("ngModel",e.enabled)("nzControl",!0),t.xp6(1),t.Q6J("nzPopconfirmTitle",t.lcZ(7,10,"base.confirmDel")+t.lcZ(8,12,"menu.job")+"?")("nz-tooltip",t.lcZ(9,14,"base.delete"))}}function B(a,d){if(1&a&&(t.TgZ(0,"a",25),t._uU(1),t.qZA()),2&a){const e=d.$implicit;t.Q6J("href",e.trackUrl,t.LSH),t.xp6(1),t.Oqu(e.trackUrl)}}function x(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"dy-tab",6),t.ALo(1,"nzI18n"),t.TgZ(2,"div",7)(3,"div",8)(4,"span"),t.YNc(5,_,2,3,"ng-template",9),t.YNc(6,g,2,4,"ng-template",9),t.TgZ(7,"i",10),t.NdJ("click",function(){return t.CHM(e),t.oxw().schedulerJobList(!0)}),t.ALo(8,"nzI18n"),t.qZA()()(),t.TgZ(9,"div",11)(10,"app-table",16,17),t.NdJ("pageChange",function(s){return t.CHM(e),t.oxw().pageChangeHandler(s,"scheduler")}),t.YNc(12,m,10,16,"ng-template",18),t.YNc(13,B,2,2,"ng-template",19),t.qZA()()()()}if(2&a){const e=t.oxw();t.Q6J("alias",t.lcZ(1,14,"job.scheduler")),t.xp6(2),t.Q6J("ngStyle",e.contentStyle),t.xp6(3),t.Q6J("behavior","job.create")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("behavior","job.batchDelete")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(8,16,"base.refresh")),t.xp6(3),t.Q6J("columns",e.columns)("data",e.schedulerJobListData)("total",e.schedulerPage.total)("pageIndex",e.schedulerPage.pageIndex)("pageSize",e.schedulerPage.pageSize)}}function M(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"i",14),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).addJob("event")}),t.ALo(1,"nzI18n"),t.qZA()}2&a&&t.Q6J("nz-tooltip",t.lcZ(1,1,"base.add"))}function P(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"i",15),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).batchDelete("event")}),t.ALo(1,"nzI18n"),t.qZA()}if(2&a){t.oxw();const e=t.MAs(11);t.Q6J("disabled",!e.checked&&!e.indeterminate)("nz-tooltip",t.lcZ(1,2,"BatchDelete.title"))}}function $(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"i",20),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(2).currentJob=r}),t.qZA(),t.TgZ(1,"i",21),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(2).editJob("event",r)}),t.ALo(2,"nzI18n"),t.qZA(),t.TgZ(3,"i",22),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(2).runJob(r)}),t.qZA(),t.TgZ(4,"i")(5,"nz-switch",23),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(2).enableJob(r)}),t.qZA()(),t.TgZ(6,"i",24),t.NdJ("nzOnConfirm",function(){const r=t.CHM(e).$implicit;return t.oxw(2).deleteConfirm(r,"event")}),t.ALo(7,"nzI18n"),t.ALo(8,"nzI18n"),t.ALo(9,"nzI18n"),t.qZA()}if(2&a){const e=d.$implicit;t.Q6J("nz-tooltip","\u67e5\u770b\u4efb\u52a1\u5217\u8868"),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(2,8,"base.edit")),t.xp6(2),t.Q6J("disabled",!e.enabled)("nz-tooltip","\u7acb\u5373\u6267\u884c"),t.xp6(2),t.Q6J("ngModel",e.enabled)("nzControl",!0),t.xp6(1),t.Q6J("nzPopconfirmTitle",t.lcZ(7,10,"base.confirmDel")+t.lcZ(8,12,"menu.job")+"?")("nz-tooltip",t.lcZ(9,14,"base.delete"))}}function S(a,d){if(1&a&&(t.TgZ(0,"a",25),t._uU(1),t.qZA()),2&a){const e=d.$implicit;t.Q6J("href",e.trackUrl,t.LSH),t.xp6(1),t.Oqu(e.trackUrl)}}function R(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"dy-tab",6),t.ALo(1,"nzI18n"),t.TgZ(2,"div",7)(3,"div",8)(4,"span"),t.YNc(5,M,2,3,"ng-template",9),t.YNc(6,P,2,4,"ng-template",9),t.TgZ(7,"i",10),t.NdJ("click",function(){return t.CHM(e),t.oxw().eventJobList(!0)}),t.ALo(8,"nzI18n"),t.qZA()()(),t.TgZ(9,"div",11)(10,"app-table",16,26),t.NdJ("pageChange",function(s){return t.CHM(e),t.oxw().pageChangeHandler(s,"event")}),t.YNc(12,$,10,16,"ng-template",27),t.YNc(13,S,2,2,"ng-template",28),t.qZA()()()()}if(2&a){const e=t.oxw();t.Q6J("alias",t.lcZ(1,14,"job.event")),t.xp6(2),t.Q6J("ngStyle",e.contentStyle),t.xp6(3),t.Q6J("behavior","job.create")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("behavior","job.batchDelete")("rawData",e.selectedGroup)("irrelevantRawData",e.isProgram),t.xp6(1),t.Q6J("nz-tooltip",t.lcZ(8,16,"base.refresh")),t.xp6(3),t.Q6J("columns",e.eventColumns)("data",e.eventJobListData)("total",e.eventPage.total)("pageIndex",e.eventPage.pageIndex)("pageSize",e.eventPage.pageSize)}}const Y=function(a){return{padding:a}};function W(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"div",29)(1,"div",30),t._uU(2),t.TgZ(3,"span")(4,"i",31),t.NdJ("click",function(){return t.CHM(e),t.MAs(9).batchDelete()}),t.ALo(5,"nzI18n"),t.qZA(),t.TgZ(6,"i",32),t.NdJ("click",function(){return t.CHM(e),t.oxw().currentJob=null}),t.qZA()()(),t.TgZ(7,"div",33)(8,"app-task-list",34,35),t.NdJ("lookLog",function(s){return t.CHM(e),t.oxw().currentTask=s}),t.qZA()()()}if(2&a){const e=t.MAs(9),o=t.oxw();t.xp6(2),t.hij(" \u4f5c\u4e1a\u540d\u79f0: ",null==o.currentJob?null:o.currentJob.name," "),t.xp6(2),t.Q6J("fontsize",24)("disabled",!(null!=e.table&&e.table.checked||null!=e.table&&e.table.indeterminate))("nz-tooltip",t.lcZ(5,6,"BatchDelete.title")),t.xp6(3),t.Q6J("ngStyle",t.VKq(8,Y,o.processId?"15px":"15px 0 0")),t.xp6(1),t.Q6J("jobId",null==o.currentJob?null:o.currentJob.id)}}let K=(()=>{class a{constructor(e,o,s,r,h,G){this.api=e,this.prcApi=o,this.message=s,this.i18n=r,this.router=h,this.deleteSer=G,this.columns=[{type:"checkbox"},{type:"index"},{i18n:"base.name",field:"name"},{i18n:"job.priority",field:"priorityZh",filterMultiple:!0,listOfFilter:[],filterFn:(F,U)=>F.some(H=>-1!==U.priority.indexOf(H))},{i18n:"process.name",field:"processName"},{i18n:"process.computionFramework",field:"computionFrameworkZh"},{i18n:"job.runningVersion",field:"processVersion"},{i18n:"job.taskUrl",field:"trackUrl",render:"trackUrl"},{i18n:"base.creator",field:"creator"},{i18n:"base.createdTime",field:"createdTime"},{i18n:"base.lastModifiedTime",field:"lastModifiedTime"},{type:"operate",render:"optColumn"}],this.eventColumns=[{type:"checkbox"},{type:"index"},{i18n:"base.name",field:"name"},{i18n:"job.priority",field:"priorityZh",filterMultiple:!0,listOfFilter:[],filterFn:(F,U)=>F.some(H=>-1!==U.priority.indexOf(H))},{i18n:"process.name",field:"processName"},{i18n:"process.computionFramework",field:"computionFrameworkZh"},{i18n:"job.runningVersion",field:"processVersion"},{i18n:"job.taskUrl",field:"trackUrl",render:"trackUrl1"},{i18n:"base.creator",field:"creator"},{i18n:"base.createdTime",field:"createdTime"},{i18n:"base.lastModifiedTime",field:"lastModifiedTime"},{type:"operate",render:"optColumn1"}],this.contentStyle={height:"calc(100% - 32px)"},this.selectedIndex=0,this.schedulerPage={pageIndex:1,pageSize:10,total:0},this.eventPage={pageIndex:1,pageSize:10,total:0}}ngOnInit(){this.processId&&(this.contentStyle={height:"calc(100% - 25px)",padding:"0 15px 15px"}),this.columns[3].listOfFilter=b.Y.map(e=>({text:e.label,value:e.value})),this.eventColumns[3].listOfFilter=b.Y.map(e=>({text:e.label,value:e.value})),this.prcApi.getComputionFrameworkList().subscribe(e=>{this.computionFrameworkData=e,this.mappingAlias(this.schedulerJobListData),this.mappingAlias(this.eventJobListData)})}ngOnChanges(e){this.schedulerJobList(),this.eventJobList()}refresh(){0===this.selectedIndex?this.taskList.refresh():1===this.selectedIndex?this.schedulerJobList():this.eventJobList()}schedulerJobList(e=!1){this.processId?this.api.getJobList(this.processId,"SCHEDULER",this.schedulerPage.pageIndex,this.schedulerPage.pageSize).subscribe(o=>{this.schedulerJobListData=o.content,this.mappingAlias(this.schedulerJobListData),this.schedulerPage.total=o.totalElements,e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):this.groupId?this.api.getJobListByGroup(this.groupId,"SCHEDULER",this.schedulerPage.pageIndex,this.schedulerPage.pageSize).subscribe(o=>{this.schedulerJobListData=o.content,this.mappingAlias(this.schedulerJobListData),this.schedulerPage.total=o.totalElements,e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):(this.schedulerJobListData=null,this.schedulerPage.total=0)}eventJobList(e=!1){this.processId?this.api.getJobList(this.processId,"EVENT",this.eventPage.pageIndex,this.eventPage.pageSize).subscribe(o=>{this.eventJobListData=o.content,this.mappingAlias(this.eventJobListData),this.eventPage.total=o.totalElements,e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):this.groupId?this.api.getJobListByGroup(this.groupId,"EVENT",this.eventPage.pageIndex,this.eventPage.pageSize).subscribe(o=>{this.eventJobListData=o.content,this.mappingAlias(this.eventJobListData),this.eventPage.total=o.totalElements,e&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)}):(this.eventJobListData=null,this.eventPage.total=0)}mappingAlias(e){!e||!this.computionFrameworkData||e.map(o=>{var s,r;o.priorityZh=null===(s=b.Y.find(h=>h.value===o.priority))||void 0===s?void 0:s.label,o.computionFrameworkZh=null===(r=this.computionFrameworkData.find(h=>h.name===o.computionFramework))||void 0===r?void 0:r.alias})}pageChangeHandler(e,o){this[`${o}Page`].pageIndex=e.pageIndex,this[`${o}Page`].pageSize=e.pageSize,this[`${o}JobList`]()}enableJob(e){this.api.enableJob(e.id,!e.enabled).subscribe(o=>{e.enabled=!e.enabled})}runJob(e){!e.enabled||this.api.runJob(e.id).subscribe(o=>{this.message.success("\u6267\u884c\u547d\u4ee4\u4e0b\u53d1\u6210\u529f!")})}stopJob(e){!e.enabled||this.api.stopJob(e.id).subscribe(o=>{this.message.success("\u505c\u6b62\u547d\u4ee4\u4e0b\u53d1\u6210\u529f!")})}deleteConfirm(e,o){this.api.deleteJob(e.id).subscribe(s=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this[`${o}JobList`]()})}batchDelete(e){this.deleteSer.open().then(()=>{this.api.deleteJob(this.schedulerJobListData.filter(o=>o.selected).map(o=>o.id).join(",")).subscribe(o=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this.schedulerTable.checked=this.schedulerTable.indeterminate=!1,this[`${e}JobList`]()})})}goBack(){this.router.navigate(["/process"])}addJob(e){let o="";const s={type:e};this.groupId?(s.groupId=this.groupId,o="/job/add"):this.processId&&(s.processId=this.processId,o=this.isProgram?"/process/program/job/add":"/process/job/add"),this.router.navigate([o],{queryParams:s})}editJob(e,o){let s="";const r={type:e};this.groupId?(r.groupId=this.groupId,s="/job/edit/"):this.processId&&(r.processId=this.processId,s=this.isProgram?"/process/program/job/edit/":"/process/job/edit/"),this.router.navigate([`${s}${o.id}`],{queryParams:r})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(O.k5),t.Y36(O.DQ),t.Y36(I.dD),t.Y36(C.wi),t.Y36(k.F0),t.Y36(f.nB))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-job-list"]],viewQuery:function(e,o){if(1&e&&(t.Gf(N,5),t.Gf(Q,5)),2&e){let s;t.iGM(s=t.CRH())&&(o.taskList=s.first),t.iGM(s=t.CRH())&&(o.schedulerTable=s.first)}},inputs:{processId:"processId",isProgram:"isProgram",groupId:"groupId",selectedGroup:"selectedGroup"},features:[t.TTD],decls:7,vars:6,consts:[[1,"layout","pr"],["dy-icon","","type","return","class","pa",3,"nz-tooltip","click",4,"ngIf"],[3,"selectedIndex","selectedIndexChange"],[3,"alias",4,"authx"],["class","modal pa",4,"ngIf"],["dy-icon","","type","return",1,"pa",3,"nz-tooltip","click"],[3,"alias"],[1,"tab-content","pr",3,"ngStyle"],[1,"toolbar"],["resAuthx","",3,"behavior","rawData","irrelevantRawData"],["dy-icon","","type","refresh",3,"nz-tooltip","click"],[1,"job-box"],[3,"groupId","processId"],["taskList",""],["dy-icon","","type","xinzeng",3,"nz-tooltip","click"],["dy-icon","","type","piliangshanchu",3,"disabled","nz-tooltip","click"],["searchField","name",3,"columns","data","total","pageIndex","pageSize","pageChange"],["schedulerTable",""],["dy-column","optColumn"],["dy-column","trackUrl"],["dy-icon","","type","eye",3,"nz-tooltip","click"],["dy-icon","","type","xiugai",3,"nz-tooltip","click"],["dy-icon","","type","yunhang",3,"disabled","nz-tooltip","click"],["nzSize","small","nzCheckedChildren","\u7981\u7528","nzUnCheckedChildren","\u542f\u7528",3,"ngModel","nzControl","click"],["dy-icon","","type","shanchu","nz-popconfirm","",3,"nzPopconfirmTitle","nz-tooltip","nzOnConfirm"],["target","_blank",3,"href"],["eventTable",""],["dy-column","optColumn1"],["dy-column","trackUrl1"],[1,"modal","pa"],[1,"bread-crumb"],["dy-icon","","type","piliangshanchu",3,"fontsize","disabled","nz-tooltip","click"],["dy-icon","","type","return",3,"click"],[1,"modal-inner",3,"ngStyle"],[3,"jobId","lookLog"],["taskList1",""]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.YNc(1,p,2,3,"i",1),t.TgZ(2,"dy-tabs",2),t.NdJ("selectedIndexChange",function(r){return o.selectedIndex=r}),t.YNc(3,l,12,15,"dy-tab",3),t.YNc(4,x,14,18,"dy-tab",3),t.YNc(5,R,14,18,"dy-tab",3),t.qZA(),t.YNc(6,W,10,10,"div",4),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",o.processId),t.xp6(1),t.Q6J("selectedIndex",o.selectedIndex),t.xp6(1),t.Q6J("authx","Job.List.Immediate"),t.xp6(1),t.Q6J("authx","Job.List.Scheduler"),t.xp6(1),t.Q6J("authx","Job.List.Event"),t.xp6(1),t.Q6J("ngIf",o.currentJob))},directives:[J.O5,f.kE,z.SY,E.N,f.RG,T.xo,f.MR,J.PC,T.Ud,v.n,w.a,D.rA,A.i,L.JJ,L.On,Z.JW],pipes:[C.o9],styles:["html.default[_ngcontent-%COMP%]   html[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   body[_ngcontent-%COMP%]{min-width:1366px}html.default[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   dl[_ngcontent-%COMP%]{margin:0;padding:0;list-style:none}html.default[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin:0}html.default[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;flex:auto;flex-direction:column}html.default[_ngcontent-%COMP%]   .fdc[_ngcontent-%COMP%]{flex-direction:column}html.default[_ngcontent-%COMP%]   .fdr[_ngcontent-%COMP%]{flex-direction:row}html.default[_ngcontent-%COMP%]   .fauto[_ngcontent-%COMP%]{flex:auto}html.default[_ngcontent-%COMP%]   .pf[_ngcontent-%COMP%]{position:fixed}html.default[_ngcontent-%COMP%]   .pr[_ngcontent-%COMP%]{position:relative}html.default[_ngcontent-%COMP%]   .pa[_ngcontent-%COMP%]{position:absolute}html.default[_ngcontent-%COMP%]   .fl[_ngcontent-%COMP%]{float:left}html.default[_ngcontent-%COMP%]   .fr[_ngcontent-%COMP%]{float:right}html.default[_ngcontent-%COMP%]   .clear-f[_ngcontent-%COMP%]{clear:both}html.default[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:#396669}html.default[_ngcontent-%COMP%]   .ant-table-pagination.ant-pagination[_ngcontent-%COMP%]{margin:0}html.default[_ngcontent-%COMP%]   .ant-pagination[_ngcontent-%COMP%]{text-align:right}html.default[_ngcontent-%COMP%]   .ant-table-column-sorter[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-table-filter-trigger[_ngcontent-%COMP%]{color:#a1a1a1}html.default[_ngcontent-%COMP%]   .ant-table-filter-trigger.active[_ngcontent-%COMP%]{color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-table-thead[_ngcontent-%COMP%]   th.ant-table-column-sort[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-table-thead[_ngcontent-%COMP%]   th.ant-table-column-has-sorters[_ngcontent-%COMP%]:hover{background:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-tree-switcher[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-tree-indent-unit[_ngcontent-%COMP%]{width:17px;color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-tree[_ngcontent-%COMP%]   .ant-tree-node-content-wrapper[_ngcontent-%COMP%]{padding:0}html.default[_ngcontent-%COMP%]   .ant-tree-checkbox-inner[_ngcontent-%COMP%]{display:inline-block}html.default[_ngcontent-%COMP%]   .ant-select-tree[_ngcontent-%COMP%]   .ant-select-tree-node-content-wrapper.ant-select-tree-node-selected[_ngcontent-%COMP%]:hover{background-color:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-modal-title[_ngcontent-%COMP%]{color:#396669}html.default[_ngcontent-%COMP%]   .ant-dropdown-menu-item-selected[_ngcontent-%COMP%], html.default[_ngcontent-%COMP%]   .ant-dropdown-menu-submenu-title-selected[_ngcontent-%COMP%]{background-color:#e2eeee}html.default[_ngcontent-%COMP%]   .ant-badge-status-processing[_ngcontent-%COMP%]{background-color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-badge-status-processing[_ngcontent-%COMP%]:after{border-color:#2a8b92}html.default[_ngcontent-%COMP%]   .ant-tooltip[_ngcontent-%COMP%]{max-width:550px;max-height:550px;overflow:hidden}html.default[_ngcontent-%COMP%]   .ant-tooltip-content[_ngcontent-%COMP%]{width:100%;height:100%;max-width:550px;max-height:542px}html.default[_ngcontent-%COMP%]   .ant-tooltip-inner[_ngcontent-%COMP%]{box-shadow:none}html.default   [_nghost-%COMP%]   .ic-return[_ngcontent-%COMP%]{right:15px;top:-9px}html.default   [_nghost-%COMP%]   .job-box[_ngcontent-%COMP%]{width:100%;height:calc(100% - 45px);overflow:auto}html.default   [_nghost-%COMP%]     .app-table td i{margin-right:5px;font-size:22px}html.default   [_nghost-%COMP%]     .app-table td i.ic-chakanrizhi1, html.default   [_nghost-%COMP%]     .app-table td i.ic-chakanzhuangtai1, html.default   [_nghost-%COMP%]     .app-table td i.ic-chakanshuju1{font-size:16px;margin-right:7px}html.default   [_nghost-%COMP%]     .app-table td i.ic-yunhang, html.default   [_nghost-%COMP%]     .app-table td i.ic-stop{font-size:18px}html.default   [_nghost-%COMP%]     .app-table td i.ic-yunhang{margin-left:3px;margin-top:1px}html.default   [_nghost-%COMP%]     .app-table td i.ic-xiugai{margin-right:0}html.default   [_nghost-%COMP%]     .app-table td i.disabled{opacity:.4;cursor:not-allowed}html.default   [_nghost-%COMP%]     .app-table td.operation-column{display:flex;justify-content:center;align-items:center}html.default   [_nghost-%COMP%]     .app-table td a{display:inline-block;overflow:hidden;word-break:keep-all;text-overflow:ellipsis;white-space:nowrap;max-width:200px}html.default   [_nghost-%COMP%]     .app-table nz-switch{position:relative;bottom:2px;white-space:nowrap}html.default   [_nghost-%COMP%]     .app-table .ant-table-pagination.ant-pagination{margin-top:8px}html.default   [_nghost-%COMP%]   .modal[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#fbffff;z-index:2}html.default   [_nghost-%COMP%]   .modal-inner[_ngcontent-%COMP%]{width:100%;height:calc(100% - 25px);overflow-y:auto}html.dark   [_nghost-%COMP%]   .ic-return[_ngcontent-%COMP%]{right:15px;top:-9px}html.dark   [_nghost-%COMP%]   .job-box[_ngcontent-%COMP%]{width:100%;height:calc(100% - 45px);overflow:auto}html.dark   [_nghost-%COMP%]     .app-table td i{margin-right:5px;font-size:22px}html.dark   [_nghost-%COMP%]     .app-table td i.ic-chakanrizhi1, html.dark   [_nghost-%COMP%]     .app-table td i.ic-chakanzhuangtai1, html.dark   [_nghost-%COMP%]     .app-table td i.ic-chakanshuju1{font-size:16px;margin-right:7px}html.dark   [_nghost-%COMP%]     .app-table td i.ic-yunhang, html.dark   [_nghost-%COMP%]     .app-table td i.ic-stop{font-size:18px}html.dark   [_nghost-%COMP%]     .app-table td i.ic-yunhang{margin-left:3px;margin-top:1px}html.dark   [_nghost-%COMP%]     .app-table td i.ic-xiugai{margin-right:0}html.dark   [_nghost-%COMP%]     .app-table td i.disabled{opacity:.4;cursor:not-allowed}html.dark   [_nghost-%COMP%]     .app-table td.operation-column{display:flex;justify-content:center;align-items:center}html.dark   [_nghost-%COMP%]     .app-table td a{display:inline-block;overflow:hidden;word-break:keep-all;text-overflow:ellipsis;white-space:nowrap;max-width:200px}html.dark   [_nghost-%COMP%]     .app-table nz-switch{position:relative;bottom:2px;white-space:nowrap}html.dark   [_nghost-%COMP%]     .app-table .ant-table-pagination.ant-pagination{margin-top:8px}html.dark   [_nghost-%COMP%]   .modal[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#fbfcff;z-index:2}html.dark   [_nghost-%COMP%]   .modal-inner[_ngcontent-%COMP%]{width:100%;height:calc(100% - 25px);overflow-y:auto}html.light-blue   [_nghost-%COMP%]   .ic-return[_ngcontent-%COMP%]{right:15px;top:-9px}html.light-blue   [_nghost-%COMP%]   .job-box[_ngcontent-%COMP%]{width:100%;height:calc(100% - 45px);overflow:auto}html.light-blue   [_nghost-%COMP%]     .app-table td i{margin-right:5px;font-size:22px}html.light-blue   [_nghost-%COMP%]     .app-table td i.ic-chakanrizhi1, html.light-blue   [_nghost-%COMP%]     .app-table td i.ic-chakanzhuangtai1, html.light-blue   [_nghost-%COMP%]     .app-table td i.ic-chakanshuju1{font-size:16px;margin-right:7px}html.light-blue   [_nghost-%COMP%]     .app-table td i.ic-yunhang, html.light-blue   [_nghost-%COMP%]     .app-table td i.ic-stop{font-size:18px}html.light-blue   [_nghost-%COMP%]     .app-table td i.ic-yunhang{margin-left:3px;margin-top:1px}html.light-blue   [_nghost-%COMP%]     .app-table td i.ic-xiugai{margin-right:0}html.light-blue   [_nghost-%COMP%]     .app-table td i.disabled{opacity:.4;cursor:not-allowed}html.light-blue   [_nghost-%COMP%]     .app-table td.operation-column{display:flex;justify-content:center;align-items:center}html.light-blue   [_nghost-%COMP%]     .app-table td a{display:inline-block;overflow:hidden;word-break:keep-all;text-overflow:ellipsis;white-space:nowrap;max-width:200px}html.light-blue   [_nghost-%COMP%]     .app-table nz-switch{position:relative;bottom:2px;white-space:nowrap}html.light-blue   [_nghost-%COMP%]     .app-table .ant-table-pagination.ant-pagination{margin-top:8px}html.light-blue   [_nghost-%COMP%]   .modal[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#fff;z-index:2}html.light-blue   [_nghost-%COMP%]   .modal-inner[_ngcontent-%COMP%]{width:100%;height:calc(100% - 25px);overflow-y:auto}"],data:{animation:[n.MC]}}),a})()},18393:(j,y,c)=>{c.d(y,{n:()=>Q});var n=c(5e3),b=c(46055),t=c(14581),O=c(77152),I=c(49727),C=c(89445),k=c(31453),f=c(72394),J=c(55535),z=c(69808),E=c(404),T=c(91984),v=c(49841);const w=["table"];function D(p,u){if(1&p&&(n.TgZ(0,"a",4),n._uU(1),n.qZA()),2&p){const i=u.$implicit;n.Q6J("href",i.trackUrl,n.LSH),n.xp6(1),n.Oqu(i.trackUrl)}}function A(p,u){if(1&p){const i=n.EpF();n.ynx(0),n.TgZ(1,"i",7),n.NdJ("click",function(){n.CHM(i);const _=n.oxw().$implicit;return n.oxw().lookDebugDataHandler(_)}),n.qZA(),n.BQk()}2&p&&(n.xp6(1),n.Q6J("fontsize",16)("nz-tooltip","\u67e5\u770b\u6570\u636e"))}function L(p,u){if(1&p){const i=n.EpF();n.TgZ(0,"i",14),n.NdJ("click",function(){n.CHM(i);const _=n.oxw(2).$implicit;return n.oxw().lookDataHandler(_,"task")}),n.qZA()}2&p&&n.Q6J("nz-tooltip","\u67e5\u770b\u5173\u8054\u5b50\u4efb\u52a1")("fontsize",18)}function Z(p,u){if(1&p){const i=n.EpF();n.TgZ(0,"i",8),n.NdJ("click",function(){n.CHM(i);const _=n.oxw().$implicit;return n.oxw().lookDataHandler(_,"log")}),n.qZA(),n.TgZ(1,"i",9),n.NdJ("click",function(){n.CHM(i);const _=n.oxw().$implicit;return n.oxw().lookDataHandler(_)}),n.qZA(),n.YNc(2,L,1,2,"i",10),n.TgZ(3,"i",11),n.NdJ("click",function(){n.CHM(i);const _=n.oxw().$implicit;return n.oxw().lookDataHandler(_,"result")}),n.qZA(),n.TgZ(4,"i",12),n.NdJ("click",function(){n.CHM(i);const _=n.oxw().$implicit;return n.oxw().stopHandler(_)}),n.qZA(),n.TgZ(5,"i",13),n.NdJ("nzOnConfirm",function(){n.CHM(i);const _=n.oxw().$implicit;return n.oxw().deleteConfirm(_)}),n.ALo(6,"nzI18n"),n.ALo(7,"nzI18n"),n.ALo(8,"nzI18n"),n.qZA()}if(2&p){const i=n.oxw().$implicit;n.Q6J("nz-tooltip","\u67e5\u770b\u65e5\u5fd7"),n.xp6(1),n.Q6J("nz-tooltip","\u67e5\u770b\u72b6\u6001"),n.xp6(1),n.Q6J("ngIf","JOBCTRL"===i.graphType),n.xp6(1),n.Q6J("disabled","FINISHED"!==i.state)("nz-tooltip","\u67e5\u770b\u6570\u636e"),n.xp6(1),n.Q6J("disabled","RUNNING"!==i.state&&"QUEUING"!==i.state)("nz-tooltip","\u7ed3\u675f")("fontsize",17),n.xp6(1),n.Q6J("nzPopconfirmTitle",n.lcZ(6,10,"base.confirmDel")+n.lcZ(7,12,"menu.job")+"?")("nz-tooltip",n.lcZ(8,14,"base.delete"))}}function N(p,u){if(1&p&&(n.YNc(0,A,2,2,"ng-container",5),n.YNc(1,Z,9,16,"ng-template",null,6,n.W1O)),2&p){const i=n.MAs(2),l=n.oxw();n.Q6J("ngIf",l.taskList)("ngIfElse",i)}}let Q=(()=>{class p{constructor(i,l,_,g,m,B){this.api=i,this.prcApi=l,this.router=_,this.message=g,this.i18n=m,this.deleteSer=B,this.lookDebugData=new n.vpe,this.page={pageIndex:1,pageSize:10,total:0},this.columns=[{type:"checkbox"},{type:"index"},{i18n:"process.name",field:"processName"},{i18n:"process.computionFramework",field:"computionFrameworkZh"},{i18n:"process.versionType",field:"processVersionTypeZh",filterMultiple:!0,listOfFilter:[],filterFn:(x,M)=>x.some(P=>-1!==M.processVersionType.indexOf(P))},{i18n:"job.runningVersion",field:"processVersion"},{i18n:"base.startTime",field:"runStartTime"},{i18n:"base.endTime",field:"runEndTime"},{i18n:"job.consuming",field:"duration"},{i18n:"base.status",field:"stateZh",filterMultiple:!0,listOfFilter:[],filterFn:(x,M)=>x.some(P=>-1!==M.state.indexOf(P))},{i18n:"job.taskUrl",render:"trackUrl"},{type:"operate",render:"opts"}]}ngOnInit(){this.columns[4].listOfFilter=b.IA.map(i=>({text:i.label,value:i.value})),this.columns[9].listOfFilter=b.hY.map(i=>({text:i.label,value:i.value})),this.prcApi.getComputionFrameworkList().subscribe(i=>{this.computionFrameworkData=i,this.mappingAlias()})}ngOnChanges(i){this.refresh()}refresh(i=!1){this.jobId?this.getTaskListByJobId(i):this.groupId?this.getTaskListByGroupId(i):this.processId?this.getTaskListByProcessId(i):this.taskList?(this.columns.splice(2,1,{i18n:"\u4f5c\u4e1a\u540d\u79f0",field:"jobName"}),this.data=this.taskList,this.mappingAlias(),this.page.total=0):(this.data=null,this.page.total=0)}getTaskListByJobId(i=!1){this.api.getJobTaskListByJob(this.jobId,this.page.pageIndex,this.page.pageSize).subscribe(l=>{this.data=l.content,this.mappingAlias(),this.page.total=l.totalElements,i&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)})}getTaskListByGroupId(i=!1){this.api.getJobTaskListByGroup(this.groupId,"IMMEDIATE",this.page.pageIndex,this.page.pageSize).subscribe(l=>{this.data=l.content,this.mappingAlias(),this.page.total=l.totalElements,i&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)})}getTaskListByProcessId(i=!1){this.api.getJobTaskList(this.processId,"IMMEDIATE",this.page.pageIndex,this.page.pageSize).subscribe(l=>{this.data=l.content,this.mappingAlias(),this.page.total=l.totalElements,i&&this.message.success(`${this.i18n.translate("base.refresh")}${this.i18n.translate("base.success")}`)})}mappingAlias(){!this.data||!this.computionFrameworkData||this.data.map(i=>{var l,_,g;i.stateZh=null===(l=b.hY.find(m=>m.value===i.state))||void 0===l?void 0:l.label,i.processVersionTypeZh=null===(_=b.IA.find(m=>m.value===i.processVersionType))||void 0===_?void 0:_.label,i.computionFrameworkZh=null===(g=this.computionFrameworkData.find(m=>m.name===i.computionFramework))||void 0===g?void 0:g.alias,i.duration=i.duration/1e3+"s"})}pageChangeHandler(i){this.page.pageIndex=i.pageIndex,this.page.pageSize=i.pageSize,this.refresh()}deleteConfirm(i){this.api.deleteJobTask(i.id).subscribe(l=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this.refresh()})}batchDelete(){this.deleteSer.open().then(()=>{this.api.deleteJobTask(this.data.filter(i=>i.selected).map(i=>i.id).join(",")).subscribe(i=>{this.message.success(`${this.i18n.translate("base.delete")}${this.i18n.translate("base.success")}`),this.table.checked=this.table.indeterminate=!1,this.refresh()})})}stopHandler(i){this.api.stopTask(i.id).subscribe(l=>{this.refresh()})}lookDebugDataHandler(i){this.lookDebugData.emit(i)}lookDataHandler(i,l="status"){this.router.navigate([`/job/result/${i.id}`],{queryParams:{processId:i.processId,type:l}})}}return p.\u0275fac=function(i){return new(i||p)(n.Y36(t.k5),n.Y36(t.DQ),n.Y36(O.F0),n.Y36(I.dD),n.Y36(C.wi),n.Y36(k.nB))},p.\u0275cmp=n.Xpm({type:p,selectors:[["app-task-list"]],viewQuery:function(i,l){if(1&i&&n.Gf(w,5),2&i){let _;n.iGM(_=n.CRH())&&(l.table=_.first)}},inputs:{taskList:"taskList",jobId:"jobId",groupId:"groupId",processId:"processId"},outputs:{lookDebugData:"lookDebugData"},features:[n.TTD],decls:4,vars:5,consts:[["searchField","processName",3,"columns","data","total","pageIndex","pageSize","pageChange"],["table",""],["dy-column","trackUrl"],["dy-column","opts"],["target","_blank",3,"href"],[4,"ngIf","ngIfElse"],["optsTemp",""],["dy-icon","","type","chakanshuju1",3,"fontsize","nz-tooltip","click"],["dy-icon","","type","chakanrizhi1",3,"nz-tooltip","click"],["dy-icon","","type","chakanzhuangtai1",3,"nz-tooltip","click"],["dy-icon","","type","renwuguanli",3,"nz-tooltip","fontsize","click",4,"ngIf"],["dy-icon","","type","chakanshuju1",3,"disabled","nz-tooltip","click"],["dy-icon","","type","stop",3,"disabled","nz-tooltip","fontsize","click"],["dy-icon","","type","shanchu","nz-popconfirm","",3,"nzPopconfirmTitle","nz-tooltip","nzOnConfirm"],["dy-icon","","type","renwuguanli",3,"nz-tooltip","fontsize","click"]],template:function(i,l){1&i&&(n.TgZ(0,"app-table",0,1),n.NdJ("pageChange",function(g){return l.pageChangeHandler(g)}),n.YNc(2,D,2,2,"ng-template",2),n.YNc(3,N,3,2,"ng-template",3),n.qZA()),2&i&&n.Q6J("columns",l.columns)("data",l.data)("total",l.page.total)("pageIndex",l.page.pageIndex)("pageSize",l.page.pageSize)},directives:[f.a,J.rA,z.O5,k.kE,E.SY,T.N,v.JW],pipes:[C.o9],encapsulation:2}),p})()}}]);